{"ast":null,"code":"var _jsxFileName = \"/Users/shyamkatariya/Developer/TatvaSoft/Bookstore/src/context/auth.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport React from \"react\";\nimport Shared from \"../utils/shared\";\nimport { RoutePaths } from \"../utils/enum\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { toast } from \"react-toastify\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst intialUserValue = {\n  id: 0,\n  email: \"\",\n  firstName: \"\",\n  lastName: \"\",\n  roleId: 0,\n  role: \"\",\n  password: \"\"\n};\nconst initialState = {\n  setUser: () => {},\n  user: intialUserValue,\n  signOut: () => {},\n  appInitialize: false\n};\nexport const AuthContext = /*#__PURE__*/createContext(initialState);\nexport const AuthWrapper = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [appInitialize, setAppInitialize] = useState(false);\n  const [user, _setUser] = useState(intialUserValue);\n  const navigate = useNavigate();\n  const {\n    pathname\n  } = useLocation();\n  const setUser = user => {\n    console.log(\"bruce@wayne2.com\", user);\n    localStorage.setItem(Shared.LocalStorageKeys.USER, JSON.stringify(user));\n    _setUser(user);\n  };\n  useEffect(() => {\n    const itemStr = JSON.parse(localStorage.getItem(Shared.LocalStorageKeys.USER)) || intialUserValue;\n    // if the item doesn't exist, return null\n    if (!itemStr.id) {\n      navigate(`${RoutePaths.Login}`);\n    }\n    _setUser(itemStr);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const signOut = () => {\n    setUser(intialUserValue);\n    localStorage.removeItem(Shared.LocalStorageKeys.USER);\n    navigate(`${RoutePaths.Login}`);\n  };\n  useEffect(() => {\n    if (pathname === RoutePaths.Login && user.id) {\n      navigate(RoutePaths.BookListing);\n    }\n    if (!user.id) {\n      return;\n    }\n    const access = Shared.hasAccess(pathname, user);\n    if (!access) {\n      toast.warning(\"Sorry, you are not authorized to access this page\");\n      navigate(RoutePaths.BookListing);\n      return;\n    }\n    setAppInitialize(true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [pathname, user]);\n  let value = {\n    user,\n    setUser,\n    signOut,\n    appInitialize\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 10\n  }, this);\n};\n_s(AuthWrapper, \"Ojppp0iJnmEiMJRzP37UQOhIHWE=\", false, function () {\n  return [useNavigate, useLocation];\n});\n_c = AuthWrapper;\nexport const useAuthContext = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuthContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"AuthWrapper\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","React","Shared","RoutePaths","useNavigate","useLocation","toast","intialUserValue","id","email","firstName","lastName","roleId","role","password","initialState","setUser","user","signOut","appInitialize","AuthContext","AuthWrapper","children","setAppInitialize","_setUser","navigate","pathname","console","log","localStorage","setItem","LocalStorageKeys","USER","JSON","stringify","itemStr","parse","getItem","Login","removeItem","BookListing","access","hasAccess","warning","value","useAuthContext"],"sources":["/Users/shyamkatariya/Developer/TatvaSoft/Bookstore/src/context/auth.jsx"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\r\nimport React from \"react\";\r\nimport Shared from \"../utils/shared\";\r\nimport { RoutePaths } from \"../utils/enum\";\r\nimport { useNavigate, useLocation } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst intialUserValue = {\r\n  id: 0,\r\n  email: \"\",\r\n  firstName: \"\",\r\n  lastName: \"\",\r\n  roleId: 0,\r\n  role: \"\",\r\n  password: \"\",\r\n};\r\n\r\nconst initialState = {\r\n  setUser: () => {},\r\n  user: intialUserValue,\r\n  signOut: () => {},\r\n  appInitialize: false,\r\n};\r\n\r\nexport const AuthContext = createContext(initialState);\r\n\r\nexport const AuthWrapper = ({ children }) => {\r\n  const [appInitialize, setAppInitialize] = useState(false);\r\n  const [user, _setUser] = useState(intialUserValue);\r\n\r\n  const navigate = useNavigate();\r\n  const { pathname } = useLocation();\r\n\r\n  const setUser = (user) => {\r\n    console.log(\"bruce@wayne2.com\", user);\r\n    localStorage.setItem(Shared.LocalStorageKeys.USER, JSON.stringify(user));\r\n    _setUser(user);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const itemStr =\r\n      JSON.parse(localStorage.getItem(Shared.LocalStorageKeys.USER)) ||\r\n      intialUserValue;\r\n    // if the item doesn't exist, return null\r\n    if (!itemStr.id) {\r\n      navigate(`${RoutePaths.Login}`);\r\n    }\r\n    _setUser(itemStr);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const signOut = () => {\r\n    setUser(intialUserValue);\r\n    localStorage.removeItem(Shared.LocalStorageKeys.USER);\r\n    navigate(`${RoutePaths.Login}`);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (pathname === RoutePaths.Login && user.id) {\r\n      navigate(RoutePaths.BookListing);\r\n    }\r\n\r\n    if (!user.id) {\r\n      return;\r\n    }\r\n    const access = Shared.hasAccess(pathname, user);\r\n    if (!access) {\r\n      toast.warning(\"Sorry, you are not authorized to access this page\");\r\n      navigate(RoutePaths.BookListing);\r\n      return;\r\n    }\r\n    setAppInitialize(true);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [pathname, user]);\r\n\r\n  let value = {\r\n    user,\r\n    setUser,\r\n    signOut,\r\n    appInitialize,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\nexport const useAuthContext = () => {\r\n  return useContext(AuthContext);\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}